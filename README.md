# max-ui-workshop
Some (hopefully) clever techniques for controling a Jitter patch with Max.

The first part of the workshop looks at how to build a video effects patch with Vizzie. In this second part, we look at how to put together a patch to control the other patch. Some of the things that we'll talk about include:

- Creating a global clock signal to drive a number of synchronized modulations
- Smoothing out control data to avoid sudden jumps
- Shaping a linear ramp into other kinds of control signals
- Mapping data from one patch to another with pattr
- Using bpatcher with arguments
- Using Link to synchronize with Live
- Using UDP to get data from other computers
- Analyzing audio to get control data

## Getting Started

Open `UI-control-explorer.maxproj`. This has everything that we'll be talking about contained in it. The most important thing is the slider at the bottom of the "controller" patcher.

![Picture of the main controller patcher, indicating the mappable slider](./img/workshop-01.png)

If we want to control the patch we made in the first part of the workshop to this one, then we need to do two things. First, make a `pattrmarker` object in the Vizzie patch. Give it a name. You have the option, but not the obligation, to be creative.

![Picture of the video patcher, indicating the pattrmarker obect](./img/workshop-02.png)

This will expose any parameter enabled objects to the global pattr system. We'll see what that means in a second. For now, add a floating point box to the video patcher that can control some parameter. Give it the range 0-1, and a scripting name.

![Picture of the video patcher, with the added floating point box, indicating that it has a min, max, and scripting name](./img/workshop-03.png)

Now back in the controller patch, we can put it all together. Duplicate the slider bpatcher, and open up the inspector. Change the patcher argumetns to `::vfx::zoom` (or `::<what-you-named-your-pattrmarker>::<what-you-named-your-number-box>`). You should see the name update in the slider and you should be able to change your number box when you drag the slider.

![Picture of the control patcher, focus on the slider itself, indication where the label changes to reflect the binding](./img/workshop-04.png)

That's the essense of this whole workshop. If you want to, you can go home now, or just play with this.

## How to Use the Slider

![Tight shot of the slider, with descriptions of what does what](./img/workshop-05.png)

One small caveat about the slider is that, even though it's not producing any sound, it requires a lead clock to function. That clock is being generated by an audio-rate `phasor~`, so we have to turn on audio for anything to work. Also, there are some extended modulation modes that require audio analysis or incoming UDP data to work. More on that later.

## A Global Clock

If you look at the top-left of the patch, you'll see we're generating a ramp from 0-1 that's being sent out to all of the sliders. We do this rather than having an individual clock for each slider because it's more efficient, and because that way all of the sliders can be in sync, if we want.

## Smoothing Out Control Data

We're using smoothing all over this patch, in some cool ways that you might not have seen before. If you jump into the slider patch and scroll down a bit, you'll see a section that looks like this:

![Tight look at switch and ramp smoothing happening in the slider patch](./img/workshop-06.png)

This is doing "swanramp" style smoothing, where "swanramp" is a cool-hip shorthand for switch-and-ramp. You can read more about it here http://msp.ucsd.edu/techniques/v0.11/book-html/node63.html. Essentially, imagine you have a continuous signal of some kind. Could be audio, could be control data. At some point, you know there's going to be a discontinuity. So you take a snapshot of the current signal and, instaed of putting out the discontinuity right away, slowly ease over to it over a short ramp.

![Animation of switch and ramp smoothing](./img/workshop-07.gif)

## Smoothing out ramps

One thing you might notice that's pretty fun is that when you change the adjusted speed of your ramp, the phasor doesn't jump right away, but rather slowly adjust to the new speed. This patches something called a phase locked loop to smooth out changes to the incoming phasor ramp in a very controlled way.